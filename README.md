# Healthylife_project
healthylife backend


## 🔧 Stack
- Nest.js, mysql


## 🔧 ERD
![healthy-project-erd](https://github.com/user-attachments/assets/6ede3d14-d524-49ee-bb09-ed9c2424b6d2)


## 구현 기능
- 웹소켓
- 현 위치 주변 장소 검색
- 소셜 로그인(passport)
- 텍스트 기반 이미지 생성
- 운동 루틴 추천
- 키워드로 관련 정보 불러오기
- 비밀번호 찾기(메일 발송) 


## 사용 api
- unsplash
- multar
- 소셜 로그인(naver,kakao,google)
- 네이버 news 
- Google Gemini
- tosspayments
- nodemailer


## 주요 기능 로직

### 1. **소셜 로그인**

- **구현 방식**: Google, Kakao, Naver의 `passport` 전략 사용.
- **로그인 흐름**:
    
    클라이언트 → 서버 로그인 URL 요청 → Passport에서 인증 코드 처리 → 콜백 처리 및 토큰 발급 → 클라이언트로 리디렉션.
    

---

### 2. **메인 페이지 기능**

- **회원가입 시** 해시태그 선택 → DB에 저장 → 선택 빈도가 높은 해시태그 기반으로 AI 추천 데이터 요청.
- **추천 콘텐츠**:
    - **건강 관련 뉴스 기사** (Naver News API)
    - **반려동물과 함께할 수 있는 운동 정보**
    - **관련 이미지**는 해시태그를 키워드로 사용해 `Unsplash API`를 통해 불러옴.

---

### 3. **마이페이지 기능**

- **결제 기능**: 토스페이먼츠 테스트 결제 API 적용.
- **운동 루틴 추천**: 결제 후 인바디 데이터 입력 → AI가 맞춤 루틴 추천.

---

### 4. **운동 장소 추천 및 실시간 채팅**

- **현 위치 기반 장소 추천**:
    - `Kakao Local API`를 통해 "운동", "헬스", "건강" 등의 키워드로 주변 장소 검색
    - 해당 장소들의 위도/경도를 클라이언트로 전달해 마커로 시각화.
- **채팅 기능**:
    - `socket.io` 이용해 방 입장/종료 처리
    - 초기 입장 시 "입장하였습니다" 메시지 전송
    - 재입장 시 이전 메시지 기록 불러오기
    - 모든 메시지는 서버에 저장

---

### 5. **무한 스크롤 채팅**

- **스크롤 방식**:
    - 위로 스크롤 시 `page`와 `limit`을 기준으로 서버에 요청
    - 총 메시지 수(`total`)와 비교해 더 이상 불러올 데이터가 없으면 요청 중단
    - 필요한 범위만 slice하여 클라이언트에 전송

---

### 6. **AI 기반 이미지 및 뉴스 추천**

- **이미지**: `Unsplash API` 이용 (비용 부담 없는 방식)
- **뉴스**: 해시태그 키워드 기반으로 뉴스 기사 불러오기 → 메인 페이지에 표시

---

### 7. **관리자 페이지**

- 전체 유저 정보 조회
- 신고 관리 및 요청 처리 UI 제공
